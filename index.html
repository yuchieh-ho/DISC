<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ€§æ ¼æ¸¬é©— (OGDI)</title>
    <style>
        body {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            max-width: 800px;
            width: 100%;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
        }
        
        /* --- å€‹äººè³‡æ–™å€å¡Š --- */
        .info-section {
            background-color: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #bbdefb;
        }
        .info-group {
            margin-bottom: 15px;
        }
        .info-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #0d47a1;
        }
        .info-group select, .info-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }

        /* --- é¡Œç›®å€å¡Šæ¨£å¼ --- */
        .question-block {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        .question-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #333;
            background-color: #eaeaea;
            padding: 8px 12px;
            border-radius: 5px;
            display: inline-block;
        }
        
        /* é¡Œç›®æ•˜è¿°å€å¡Š */
        .question-description {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 5px solid #6c757d;
        }
        .desc-item {
            margin-bottom: 10px;
            font-size: 1.05em;
            line-height: 1.5;
            color: #444;
        }
        .desc-item:last-child {
            margin-bottom: 0;
        }

        /* é¸é …å€å¡Š */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding-left: 10px;
        }
        .option-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            transition: background 0.2s;
        }
        .option-label:hover {
            background-color: #f0f8ff;
            border-color: #b3d7ff;
        }
        .option-label input {
            margin-right: 15px;
            transform: scale(1.2);
        }
        
        .text-a { color: #d9534f; font-weight: bold; }
        .text-b { color: #0275d8; font-weight: bold; }

        button.submit-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #28a745;
            color: white;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
        }
        button.submit-btn:hover {
            background-color: #218838;
        }

        /* --- çµæœå€å¡Š --- */
        #result-area {
            margin-top: 30px;
            padding: 20px;
            background-color: #e9ecef;
            border-radius: 5px;
            display: none;
        }
        
        .final-type-box {
            text-align: center;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #28a745;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .final-type-title {
            font-size: 1.2em;
            color: #555;
            margin-bottom: 10px;
        }
        .final-type-result {
            font-size: 2.5em;
            font-weight: bold;
            color: #28a745;
        }
        
        .user-result-summary {
            background: #fff;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
            border-left: 5px solid #007bff;
            font-size: 0.95em;
            line-height: 1.6;
        }

        /* --- æ–°å¢ï¼šæ€§æ ¼è§£é‡‹å€å¡Šæ¨£å¼ --- */
        .desc-box {
            background-color: #fff;
            padding: 25px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-top: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .desc-box h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #28a745;
            padding-bottom: 10px;
            font-size: 1.5em;
            margin-bottom: 15px;
        }
        .desc-box p {
            font-size: 1.1em;
            line-height: 1.8;
            color: #444;
            margin-bottom: 15px;
            text-align: justify; /* è®“æ–‡å­—å°é½Šæ›´æ•´é½Š */
        }
        .desc-highlight {
            font-weight: bold;
            color: #d35400; /* å¼·èª¿æ–‡å­—é¡è‰² */
        }

    </style>
</head>
<body>

<div class="container">
    <h1>è¾¨è­˜ä½ çš„ DISC äººæ ¼é¡å‹ï¼ˆå‡ºè™•ç™½é‡‘å®šå¾‹ï¼‰</h1>
    <p style="color: #666; margin-bottom: 20px;">
        è¦ªæ„›çš„è‡¨åºŠæ•™å¸«èˆ‡æ–°é€²è­·ç†å¸«æ‚¨å¥½ï¼š<br>
        æœ¬æ€§æ ¼æ¸¬é©—å”åŠ©è‡¨åºŠæ•™å¸«èˆ‡å­¸å“¡å½¼æ­¤äº†è§£åœ¨äº’å‹•ã€æºé€šèˆ‡å­¸ç¿’ä¸Šçš„æ€§æ ¼å‚¾å‘ï¼Œä½œç‚ºæœªä¾†æ•™å­¸èˆ‡åˆä½œçš„åƒè€ƒä¾æ“šã€‚<br>
        æœ¬æ¸¬é©—æ²’æœ‰å°éŒ¯ï¼Œä¹Ÿä¸åšèƒ½åŠ›è©•åƒ¹ï¼Œè«‹æ‚¨ä¾ç…§ç¬¬ä¸€ç›´è¦ºä½œç­”ï¼Œé¸æ“‡æœ€ç¬¦åˆæ‚¨ã€Œå¹³æ™‚çœŸå¯¦ç‹€æ³ã€çš„é¸é …å³å¯ã€‚
    </p>

    <div class="info-section">
        <div class="info-group">
            <label for="user-role">èº«ä»½é¸æ“‡</label>
            <select id="user-role">
                <option value="" disabled selected>-- è«‹é¸æ“‡èº«ä»½ --</option>
                <option value="è€å¸«">è€å¸«</option>
                <option value="å­¸ç”Ÿ">å­¸ç”Ÿ</option>
            </select>
        </div>
        
        <div class="info-group">
            <label for="user-name">å§“å</label>
            <input type="text" id="user-name" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å">
        </div>

        <div class="info-group">
            <label for="user-id">å“¡å·¥ç·¨è™Ÿ</label>
            <input type="text" id="user-id" placeholder="è«‹è¼¸å…¥æ‚¨çš„å“¡å·¥ç·¨è™Ÿ">
        </div>

        <div class="info-group">
            <label for="user-unit">æ‰€å±¬å–®ä½</label>
            <select id="user-unit">
                <option value="" disabled selected>-- è«‹é¸æ“‡å–®ä½ --</option>
                <option value="ND">ND</option>
                <option value="15A">15A</option>
                <option value="15B">15B</option>
                <option value="13B">13B</option>
                <option value="12A">12A</option>
                <option value="12B">12B</option>
                <option value="11A">11A</option>
                <option value="10B">10B</option>
                <option value="9A">9A</option>
                <option value="9B">9B</option>
                <option value="8A">8A</option>
                <option value="8B">8B</option>
                <option value="6C">6C</option>
                <option value="5A">5A</option>
                <option value="5B">5B</option>
                <option value="3D">3D</option>
                <option value="RCC">RCC</option>
                <option value="MICU">MICU</option>
                <option value="CCU">CCU</option>
                <option value="SICU">SICU</option>
                <option value="PICU">PICU</option>
                <option value="OPD">OPD</option>
                <option value="ER">ER</option>
                <option value="OR">OR</option>
                <option value="POR">POR</option>
                <option value="CSR">CSR</option>
            </select>
        </div>
    </div> 

    <p style="color: #666; margin-bottom: 20px;">
        ã€å¡«ç­”èªªæ˜ï¼ˆè«‹å‹™å¿…é–±è®€ï¼‰ã€‘<br>
        â€¢ æ¯ä¸€é¡Œéƒ½åŒ…å« A èˆ‡ B å…©ç¨®ä¸åŒæè¿°<br>
        â€¢ è«‹åªé¸æ“‡ä¸€å€‹é¸é …ï¼Œä»£è¡¨æ‚¨è¼ƒæ¥è¿‘å“ªä¸€ç¨®æè¿°<br>
        â€¢ æ¯é¡Œå…±æœ‰ 4 å€‹é¸é …ï¼Œè«‹ä¾ã€Œç¬¦åˆç¨‹åº¦ã€é¸æ“‡å…¶ä¸€
    </p>

    <p style="color: #666; margin-bottom: 20px;">
        ã€é¸é …èªªæ˜ï¼ˆè«‹å‹™å¿…é–±è®€ï¼‰ã€‘<br>
        â€¢ å®Œå…¨ç¬¦åˆ Aï¼šA çš„æè¿°éå¸¸ç¬¦åˆæˆ‘<br>
        â€¢ æ¯”è¼ƒç¬¦åˆ Aï¼šA çš„æè¿°å¤§è‡´ç¬¦åˆæˆ‘<br>
        â€¢ å®Œå…¨ç¬¦åˆ Bï¼šB çš„æè¿°éå¸¸ç¬¦åˆæˆ‘<br>
        â€¢ æ¯”è¼ƒç¬¦åˆ Bï¼šB çš„æè¿°å¤§è‡´ç¬¦åˆæˆ‘<br>
	â€¢ è‹¥ Aã€B çš†ä¸å®Œå…¨ç¬¦åˆï¼Œè«‹é¸æ“‡ã€Œç›¸å°è¼ƒæ¥è¿‘ã€çš„ä¸€æ–¹
    </p>
    
    <form id="quizForm">
        <div id="questions-container"></div>
        <button type="button" id="submitBtn" class="submit-btn" onclick="calculateResult()">æŸ¥çœ‹çµæœä¸¦é€å‡º</button>
    </form>

    <div id="result-area">
        <div class="final-type-box">
            <div class="final-type-title">æ‚¨çš„æ€§æ ¼é¡å‹åˆ†æçµæœ</div>
            <div id="final-type-text" class="final-type-result">è¨ˆç®—ä¸­...</div>
        </div>

        <div class="user-result-summary">
            <strong>èº«ä»½ï¼š</strong><span id="res-role"></span><br>
            <strong>å§“åï¼š</strong><span id="res-name"></span><br>
            <strong>ç·¨è™Ÿï¼š</strong><span id="res-id"></span><br>
            <strong>å–®ä½ï¼š</strong><span id="res-unit"></span>
        </div>

        <div id="type-description-box" class="desc-box">
            </div>

        <p style="margin-top:20px; font-size: 0.9em; color: #555; text-align: center;">* æœ¬æ¸¬é©—çµæœä¸¦éèƒ½åŠ›æˆ–è¡¨ç¾è©•åƒ¹ï¼Œåƒ…å»ºè­°ä½œç‚ºè‡¨åºŠæ•™å­¸èˆ‡å­¸ç¿’èª¿æ•´ä¹‹åƒè€ƒ *</p>
    </div>
</div>

<script>
    // --- 1. é¡Œç›®è³‡æ–™ ---
    const questions = [
        { A: "æˆ‘æ˜¯çœŸå¿ƒæƒ³äº†è§£åˆ¥äººï¼Œä¸¦å»ºç«‹å‹èª¼ã€‚", B: "æˆ‘é€šå¸¸ä¸æœƒé–‹æ”¾å¿ƒèƒ¸å»äº†è§£åˆ¥äººï¼Œä¸¦èˆ‡ä»–å€‘å»ºç«‹å‹èª¼ã€‚" }, 
        { A: "æˆ‘åæ‡‰è¼ƒæ…¢è€Œä¸”æœƒæ·±æ€ç†Ÿæ…®ã€‚", B: "æˆ‘åæ‡‰è¿…é€Ÿè€Œä¸”æ˜¯è‡ªå‹•è‡ªç™¼çš„ã€‚" },
        { A: "å°æ–¼åˆ¥äººä½”ç”¨æˆ‘çš„æ™‚é–“ï¼Œæˆ‘ä¿æŒå¯©æ…çš„æ…‹åº¦ã€‚", B: "å°æ–¼åˆ¥äººä½”ç”¨æˆ‘çš„æ™‚é–“ï¼Œæˆ‘ç¸½æ˜¯ç›¡é‡é…åˆã€‚" },
        { A: "åœ¨ç¤¾äº¤å ´åˆä¸­ï¼Œæˆ‘ç¸½æœƒä¸»å‹•è‡ªæˆ‘ä»‹ç´¹ã€‚", B: "åœ¨ç¤¾äº¤å ´åˆä¸­ï¼Œæˆ‘ç¸½æ˜¯ç­‰è‘—åˆ¥äººèµ°éä¾†ï¼Œåƒæˆ‘ä»‹ç´¹ä»–å€‘è‡ªå·±ã€‚" },
        { A: "èˆ‡ä»–äººäº¤è«‡æ™‚ï¼Œæˆ‘é€šå¸¸æŠŠè«‡è©±çš„ç„¦é»æ”¾åœ¨å°æ–¹èº«ä¸Šï¼Œé›–ç„¶æœ‰æ™‚èˆ‡åŸä¾†çš„ä¸»é¡Œä¸ç”šç›¸é—œï¼Œæˆ‘ä¹Ÿä¸ä»¥ç‚ºæ„ã€‚", B: "èˆ‡ä»–äººäº¤è«‡æ™‚ï¼Œæˆ‘é€šå¸¸æŠŠè«‡è©±çš„ä¸»é¡Œï¼Œæ”¾åœ¨å·¥ä½œã€è­°é¡Œæˆ–å…¶ä»–äº‹ç‰©ä¸Š" },
        { A: "æˆ‘é€šå¸¸æœ‰é»çŒ¶è±«ä¸æ±ºï¼Œè€Œä¸”å°ç·©æ…¢çš„ç¯€å¥æœ‰è€å¿ƒã€‚", B: "æˆ‘é€šå¸¸ååˆ†æœæ±ºï¼Œè€Œä¸”å°ç·©æ…¢çš„ç¯€å¥æ²’ä»€éº¼è€æ€§ã€‚" },
        { A: "æˆ‘é€šå¸¸ä¾äº‹å¯¦æˆ–è­‰æ“šä¾†æ±ºå®šäº‹æƒ…ã€‚", B: "æˆ‘é€šå¸¸é æ„Ÿè¦ºæˆ–ç¶“é©—ä¾†æ±ºå®šäº‹æƒ…ã€‚" },
        { A: "æˆ‘å–œæ­¡åƒèˆ‡åœ˜é«”è¨è«–ã€‚", B: "æˆ‘ä¸å–œæ­¡åƒèˆ‡åœ˜é«”è¨è«–" },
        { A: "æˆ‘é€šå¸¸é¡˜æ„å’Œåˆ¥äººå…±è­˜ï¼Œä¸¦åœ¨å¯èƒ½æ™‚æä¾›å”åŠ©ã€‚", B: "æˆ‘é€šå¸¸å–œæ­¡ç¨ç«‹å®Œæˆä¸€é …å·¥ä½œï¼Œå³ä½¿æ˜¯åœ˜éšŠçš„å·¥ä½œï¼Œæˆ‘ä¹Ÿå¸Œæœ›è‡ªå·±å®Œæˆè‡ªå·±çš„éƒ¨åˆ†ã€‚" },
        { A: "æˆ‘é€šå¸¸æœƒå•å•é¡Œï¼Œæˆ–æ˜¯è©¦æ¢æ€§ã€å§”å©‰åœ°ç™¼è¡¨æ„è¦‹ã€‚", B: "æˆ‘é€šå¸¸æœƒåšå‡ºç›´æ¥äº†ç•¶åœ°é™³è¿°ï¼Œæˆ–ç›´æ¥è¡¨é”å‡ºæˆ‘çš„æ„è¦‹ã€‚" },
        { A: "æˆ‘ä¸»è¦è‘—é‡åœ¨ç”Ÿæ„ã€è§€å¿µåŠæˆæœä¸Šã€‚", B: "æˆ‘ä¸»è¦è‘—é‡åœ¨äººã€äº’å‹•åŠæ„Ÿè¦ºä¸Šã€‚" },
        { A: "æˆ‘ä½¿ç”¨æ‰‹å‹¢ã€è‡‰éƒ¨è¡¨æƒ…æˆ–æŠ‘æšé “æŒ«ï¼Œä¾†å¼·èª¿æˆ‘èªªè©±çš„é‡é»ã€‚", B: "æˆ‘ä¸ä½¿ç”¨æ‰‹å‹¢ã€è‡‰éƒ¨è¡¨æƒ…æˆ–æŠ‘æšé “æŒ«ï¼Œä¾†å¼·èª¿æˆ‘èªªè©±çš„é‡é»ã€‚" },
        { A: "æˆ‘é€šå¸¸æœƒæ¥å—åˆ¥äººçš„è§€é»ï¼ˆåŒ…æ‹¬ä¸»æ„ã€æ„Ÿè¦ºåŠé¡§æ…®ï¼‰ã€‚", B: "æˆ‘é€šå¸¸ä¸æœƒæ¥å—åˆ¥äººçš„è§€é»ï¼ˆåŒ…æ‹¬ä¸»æ„ã€æ„Ÿè¦ºåŠé¡§æ…®ï¼‰ã€‚" },
        { A: "æˆ‘é€šå¸¸åªåœ¨å¯©æ…è©•ä¼°å¾ŒåŠå¯é æ¸¬çš„æƒ…æ³ä¸‹ï¼Œæ‰æœƒå†’éšªåŠåšå‡ºæ”¹è®Šã€‚", B: "æˆ‘é€šå¸¸æœƒåœ¨å……æ»¿æ´»åŠ›åŠæœªçŸ¥çš„ç‹€æ³ä¸‹ï¼Œå‹‡æ–¼å†’éšªä¸¦åšå‡ºæ”¹è®Šã€‚" },
        { A: "æˆ‘é€šå¸¸æœƒä¿æœ‰å€‹äººçš„æ„Ÿè¦ºåŠçœ‹æ³•ï¼Œåªæœ‰åœ¨æˆ‘é¡˜æ„æ™‚ï¼Œæ‰æœƒèˆ‡äººåˆ†äº«ã€‚", B: "æˆ‘å¸¸å°‡èˆ‡åˆ¥äººåˆ†äº«åŠè¨è«–æˆ‘çš„æ„Ÿè¦ºï¼Œè¦–ç‚ºè¼•é¬†è‡ªåœ¨çš„äº‹ã€‚" },
        { A: "æˆ‘é€šå¸¸å¸¸æœƒå°‹æ±‚å¶„æ–°æˆ–ä¸åŒçš„ç¶“é©—åŠç‹€æ³ã€‚", B: "æˆ‘é€šå¸¸æœƒé¸æ“‡å·²çŸ¥æˆ–ç†Ÿç¨”çš„ç‹€æ³ã€‚" },
        { A: "å°åˆ¥äººæå‡ºçš„è­°é¡Œã€èˆˆè¶£åŠé—œå¿ƒçš„äº‹ç‰©ï¼Œæˆ‘é€šå¸¸æœƒæœ‰æ‰€åæ‡‰ã€‚", B: "æˆ‘åªå°è‡ªå·±çš„è­°é¡Œã€èˆˆè¶£åŠé—œå¿ƒçš„äº‹ç‰©æœ‰èˆˆè¶£ã€‚" },
        { A: "æˆ‘å°åˆ¥äººå’Œæˆ‘ä¹‹é–“äººéš›é—œä¿‚çš„è¡çªåæ‡‰ï¼Œæ˜¯ç·©æ…¢è€Œä¸”ä¸ç›´æ¥çš„ã€‚", B: "æˆ‘å°åˆ¥äººå’Œæˆ‘ä¹‹é–“äººéš›é—œä¿‚çš„è¡çªåæ‡‰ï¼Œæ˜¯è¿…é€Ÿè€Œä¸”ç›´æ¥çš„ã€‚" }
    ];

    // --- å®šç¾©æ€§æ ¼è§£é‡‹æ–‡å­— (ç¢ºä¿æ–‡å­—æ­£ç¢º) ---
    const typeContent = {
        'D': `<h3>D å‹ï¼ˆDominanceï½œä¸»å°å‹ï¼‰</h3>
              <p>è¡Œå‹•å¿«é€Ÿã€ç›®æ¨™æ˜ç¢ºï¼Œé‡è¦–æ•ˆç‡èˆ‡æˆæœï¼Œé¢å°ä»»å‹™å¤šä¸»å‹•æ‰¿æ“”ã€‚</p>
              <p><span class="desc-highlight">å­¸ç¿’é¢¨æ ¼ï¼š</span>ä»¥å¯¦ä½œèˆ‡æ˜ç¢ºçµè«–ç‚ºä½³ã€‚</p>
              <p><span class="desc-highlight">æ•™å­¸å»ºè­°ï¼š</span>æŒ‡å°å®œç›´å…¥é‡é»ã€å›é¥‹å…·é«”ï¼Œé¿å…éåº¦å†—é•·èªªæ˜ã€‚</p>`,
        'I': `<h3>I å‹ï¼ˆInfluenceï½œå½±éŸ¿å‹ï¼‰</h3>
              <p>ç†±æƒ…å¤–å‘ã€æ¨‚æ–¼äº’å‹•ï¼Œå®¹æ˜“åœ¨åœ˜éšŠä¸­å»ºç«‹é—œä¿‚èˆ‡æ°£æ°›ã€‚</p>
              <p><span class="desc-highlight">å­¸ç¿’é¢¨æ ¼ï¼š</span>å‹•æ©Ÿä¾†è‡ªé¼“å‹µèˆ‡è‚¯å®šã€‚</p>
              <p><span class="desc-highlight">æ•™å­¸å»ºè­°ï¼š</span>å¯å¤šçµ¦æ­£å‘å›é¥‹èˆ‡è¨è«–æ©Ÿæœƒï¼ŒåŒæ™‚å”åŠ©èšç„¦é‡é»èˆ‡å®Œæˆç´°ç¯€ã€‚</p>`,
        'S': `<h3>S å‹ï¼ˆSteadinessï½œç©©å®šå‹ï¼‰</h3>
              <p>æº«å’Œç©©å®šã€é…åˆåº¦é«˜ï¼Œé‡è¦–é—œä¿‚èˆ‡åœ˜éšŠå’Œè«§ã€‚</p>
              <p><span class="desc-highlight">å­¸ç¿’é¢¨æ ¼ï¼š</span>éœ€è¦å®‰å…¨æ„Ÿèˆ‡ç†Ÿæ‚‰æµç¨‹ã€‚</p>
              <p><span class="desc-highlight">æ•™å­¸å»ºè­°ï¼š</span>å®œå¾ªåºæ¼¸é€²ã€æ¸…æ¥šèªªæ˜ï¼Œé¿å…è‡¨æ™‚è®Šå‹•æˆ–é«˜å£“å‚¬ä¿ƒã€‚</p>`,
        'C': `<h3>C å‹ï¼ˆConscientiousnessï½œè¬¹æ…å‹ï¼‰</h3>
              <p>é‡è¦–æº–ç¢ºæ€§èˆ‡è¦ç¯„ï¼Œåšäº‹è¬¹æ…ã€ç¿’æ…£å…ˆç†è§£åŸå‰‡èˆ‡æµç¨‹ã€‚</p>
              <p><span class="desc-highlight">å­¸ç¿’é¢¨æ ¼ï¼š</span>åå¥½å®Œæ•´è³‡è¨Šèˆ‡é‚è¼¯èªªæ˜ã€‚</p>
              <p><span class="desc-highlight">æ•™å­¸å»ºè­°ï¼š</span>å®œæä¾›æ˜ç¢ºæ¨™æº–èˆ‡æ™‚é–“ï¼Œé¿å…æ¨¡ç³ŠæŒ‡ä»¤ã€‚</p>`
    };

    // --- 2. åˆå§‹åŒ–é¡Œç›® ---
    const container = document.getElementById('questions-container');

    questions.forEach((q, index) => {
        const n = index + 1;
        const html = `
            <div class="question-block">
                <div class="question-title">ç¬¬ ${n} é¡Œ</div>
                <div class="question-description">
                    <div class="desc-item"><span class="text-a">Aï¼š</span>${q.A}</div>
                    <div class="desc-item"><span class="text-b">Bï¼š</span>${q.B}</div>
                </div>
                <div class="options-container">
                    <label class="option-label">
                        <input type="radio" name="q${n}" value="3">
                        <div><span class="text-a">å®Œå…¨ç¬¦åˆ A</span></div>
                    </label>
                    <label class="option-label">
                        <input type="radio" name="q${n}" value="2">
                        <div><span class="text-a">æ¯”è¼ƒç¬¦åˆ A</span></div>
                    </label>
                    <label class="option-label">
                        <input type="radio" name="q${n}" value="1">
                        <div><span class="text-b">æ¯”è¼ƒç¬¦åˆ B</span></div>
                    </label>
                    <label class="option-label">
                        <input type="radio" name="q${n}" value="0">
                        <div><span class="text-b">å®Œå…¨ç¬¦åˆ B</span></div>
                    </label>
                </div>
            </div>
        `;
        container.insertAdjacentHTML('beforeend', html);
    });

    // --- 3. è¨ˆç®—é‚è¼¯ ---
    function calculateResult() {
        const userRole = document.getElementById('user-role').value;
        const userName = document.getElementById('user-name').value.trim();
        const userId = document.getElementById('user-id').value.trim();
        const userUnit = document.getElementById('user-unit').value;

        if (!userRole) { alert("è«‹é¸æ“‡ã€Œèº«ä»½ã€"); document.getElementById('user-role').focus(); return; }
        if (!userName) { alert("è«‹è¼¸å…¥ã€Œå§“åã€"); document.getElementById('user-name').focus(); return; }
        if (!userId) { alert("è«‹è¼¸å…¥ã€Œå“¡å·¥ç·¨è™Ÿã€"); document.getElementById('user-id').focus(); return; }
        if (!userUnit) { alert("è«‹é¸æ“‡ã€Œæ‰€å±¬å–®ä½ã€"); document.getElementById('user-unit').focus(); return; }

        let O = 0, G = 0, D = 0, I = 0;
        let allAnswered = true;

        for (let n = 1; n <= 18; n++) {
            const radios = document.getElementsByName(`q${n}`);
            let valA = -1;
            for (const radio of radios) {
                if (radio.checked) {
                    valA = parseInt(radio.value);
                    break;
                }
            }
            if (valA === -1) { allAnswered = false; break; }

            let valB = 3 - valA;

            if ((n + 3) % 4 === 0) { O += valA; G += valB; } 
            else if ((n + 1) % 4 === 0) { O += valB; G += valA; } 
            else if (n % 4 === 0) { D += valA; I += valB; } 
            else if ((n + 2) % 4 === 0) { D += valB; I += valA; }
        }

        if (!allAnswered) {
            alert("æ‚¨é‚„æœ‰é¡Œç›®æœªå®Œæˆï¼Œè«‹å®Œæˆæ‰€æœ‰ 18 é¡Œå¾Œå†æŸ¥çœ‹çµæœï¼");
            return;
        }

        document.getElementById('res-role').innerText = userRole;
        document.getElementById('res-name').innerText = userName;
        document.getElementById('res-id').innerText = userId;
        document.getElementById('res-unit').innerText = userUnit;

        // è¨ˆç®—æœ€é«˜åˆ†
        let scores = [
            { type: 'O', val: O },
            { type: 'G', val: G },
            { type: 'D', val: D },
            { type: 'I', val: I }
        ];

        scores.sort((a, b) => b.val - a.val);

        let top1 = scores[0].type;
        let top2 = scores[1].type;
        
        const has = (type) => (top1 === type || top2 === type);

        let finalType = "";
        let resultKey = ""; 
        
        // é‚è¼¯åˆ¤å®š
        if (has('G') && has('D')) {
            finalType = "ğŸ¯ è€è™ D æ”¯é…å‹";
            resultKey = "D";
        } else if (has('O') && has('D')) {
            finalType = "ğŸ¦š å­”é›€ I å½±éŸ¿å‹";
            resultKey = "I";
        } else if (has('O') && has('I')) {
            finalType = "ğŸ¨ ç„¡å°¾ç†Š S ç©©å¥å‹";
            resultKey = "S";
        } else if (has('G') && has('I')) {
            finalType = "ğŸ¦‰ è²“é ­é·¹ C åˆ†æå‹";
            resultKey = "C";
        } else {
            finalType = `è¤‡åˆé¡å‹`; 
            resultKey = "MIX"; 
        }

        document.getElementById('final-type-text').innerText = finalType;

        // --- é—œéµä¿®æ”¹ï¼šåªé¡¯ç¤ºå°æ‡‰çš„å–®ä¸€è§£é‡‹ ---
        const descBox = document.getElementById('type-description-box');
        if (typeContent[resultKey]) {
            descBox.innerHTML = typeContent[resultKey];
        } else {
            // å¦‚æœæ˜¯è¤‡åˆå‹ (ä¸åœ¨å››å¤§é¡ä¸­)ï¼Œé¡¯ç¤ºæç¤ºè¨Šæ¯
            descBox.innerHTML = "<p>æ‚¨çš„æ¸¬é©—çµæœé¡¯ç¤ºæ‚¨å…¼å…·å¤šç¨®ç‰¹è³ªï¼Œå»ºè­°æ‚¨å¯ä»¥åŒæ™‚åƒè€ƒå‰å…©é …é«˜åˆ†ç‰¹è³ªçš„æ•™å­¸å»ºè­°ï¼Œæˆ–è«®è©¢è‡¨åºŠæ•™å¸«ã€‚</p>";
        }

        document.getElementById('result-area').style.display = 'block';
        document.getElementById('result-area').scrollIntoView({ behavior: 'smooth' });
    
        const btn = document.getElementById('submitBtn');
        btn.innerText = "è³‡æ–™å‚³é€ä¸­...";
        btn.disabled = true;

        const googleScriptUrl = "https://script.google.com/macros/s/AKfycbyLVoR7xrOTq_ccbXyT3Pl_JYRJqQGKOdHVIdE9GrXSaGl9UN_gNHwESY8lW4Vf1_IYGA/exec"; 

        const dataToSend = {
            role: userRole,
            name: userName,
            id: userId,
            unit: userUnit,
            O: O, G: G, D: D, I: I,
            finalType: finalType
        };

        fetch(googleScriptUrl, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(dataToSend)
        }).then(() => {
            btn.innerText = "çµæœå·²é€å‡º";
            alert("æ¸¬é©—å®Œæˆï¼");
        }).catch(err => {
            console.error(err);
            btn.innerText = "å‚³é€å¤±æ•—";
            alert("Error");
        });
    }
    
</script>

</body>
</html>
